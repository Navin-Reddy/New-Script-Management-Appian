-- phpMyAdmin SQL Dump
-- version 5.1.1deb5ubuntu1
-- https://www.phpmyadmin.net/
--
-- Host: localhost:3306
-- Generation Time: Jul 27, 2024 at 11:45 AM
-- Server version: 8.0.37-0ubuntu0.22.04.3
-- PHP Version: 8.1.2-1ubuntu2.14

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
START TRANSACTION;
SET time_zone = "+00:00";

--
-- Database: `appianbusiness`
--

-- --------------------------------------------------------

--
-- Table structure for table `NSM_APPLICATION_LOOKUP`
--

CREATE TABLE `NSM_APPLICATION_LOOKUP` (
  `ID` int NOT NULL,
  `APPLICATION_NAME` varchar(255) DEFAULT NULL,
  `CREATED_BY` varchar(255) DEFAULT NULL,
  `CREATED_ON` datetime(6) DEFAULT NULL,
  `IS_ACTIVE` bit(1) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

-- --------------------------------------------------------

--
-- Table structure for table `NSM_APPLICATION_LOOKUP_EVENT_TYPE`
--

CREATE TABLE `NSM_APPLICATION_LOOKUP_EVENT_TYPE` (
  `ID` int NOT NULL,
  `EVENT_NAME` varchar(255) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

--
-- Dumping data for table `NSM_APPLICATION_LOOKUP_EVENT_TYPE`
--

INSERT INTO `NSM_APPLICATION_LOOKUP_EVENT_TYPE` (`ID`, `EVENT_NAME`) VALUES
(1, 'Created Application Lookup'),
(2, 'Updated Application Lookup');

-- --------------------------------------------------------

--
-- Table structure for table `NSM_CONF_APPLICATION_USERS`
--

CREATE TABLE `NSM_CONF_APPLICATION_USERS` (
  `ID` int NOT NULL,
  `USERNAME` varchar(255) DEFAULT NULL,
  `IS_ACTIVE` bit(1) DEFAULT NULL,
  `APPLICATION_LOOKUP_ID` int DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

-- --------------------------------------------------------

--
-- Table structure for table `NSM_SCRIPT_DETAILS`
--

CREATE TABLE `NSM_SCRIPT_DETAILS` (
  `ID` int NOT NULL,
  `REFERENCE_NUMBER` varchar(255) DEFAULT NULL,
  `JIRA_TICKET_ID` varchar(255) DEFAULT NULL,
  `OBJECT_NAME` varchar(255) DEFAULT NULL,
  `COMMENTS` varchar(500) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci DEFAULT NULL,
  `IS_MOVED_TO_SIT` bit(1) DEFAULT NULL,
  `IS_MOVED_TO_UAT` bit(1) DEFAULT NULL,
  `IS_MOVED_TO_STAGING` bit(1) DEFAULT NULL,
  `IS_MOVED_TO_PROD` bit(1) DEFAULT NULL,
  `CREATED_BY` varchar(255) DEFAULT NULL,
  `CREATED_ON` datetime(6) DEFAULT NULL,
  `MODIFIED_BY` varchar(255) DEFAULT NULL,
  `MODIFIED_ON` datetime(6) DEFAULT NULL,
  `APPLICATION_TYPE_ID` int DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

-- --------------------------------------------------------

--
-- Table structure for table `NSM_SCRIPT_DETAILS_EVENT_HISTORY`
--

CREATE TABLE `NSM_SCRIPT_DETAILS_EVENT_HISTORY` (
  `ID` int NOT NULL,
  `RECORD_ID` int DEFAULT NULL,
  `EVENT_TYPE_ID` int DEFAULT NULL,
  `USER` varchar(255) DEFAULT NULL,
  `AUTOMATION_TYPE_ID` int DEFAULT NULL,
  `TIMESTAMP` datetime(6) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

-- --------------------------------------------------------

--
-- Table structure for table `NSM_SCRIPT_DETAILS_EVENT_TYPE`
--

CREATE TABLE `NSM_SCRIPT_DETAILS_EVENT_TYPE` (
  `ID` int NOT NULL,
  `EVENT_NAME` varchar(255) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

-- --------------------------------------------------------

--
-- Table structure for table `NSM_SCRIPT_TEXT`
--

CREATE TABLE `NSM_SCRIPT_TEXT` (
  `ID` int NOT NULL,
  `SCRIPT_DETAILS_ID` int DEFAULT NULL,
  `SCRIPT` varchar(4000) DEFAULT NULL,
  `IS_ACTIVE` bit(1) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

-- --------------------------------------------------------

--
-- Stand-in structure for view `NSM_SCRIPT_VIEW`
-- (See below for the actual view)
--
CREATE TABLE `NSM_SCRIPT_VIEW` (
`SCRIPT_DETAILS_ID` int
,`REFERENCE_NUMBER` varchar(255)
,`SCRIPT` mediumtext
,`ROW_NUMBER` bigint unsigned
);

-- --------------------------------------------------------

--
-- Structure for view `NSM_SCRIPT_VIEW`
--
DROP TABLE IF EXISTS `NSM_SCRIPT_VIEW`;

CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `NSM_SCRIPT_VIEW`  AS SELECT `NSD`.`ID` AS `SCRIPT_DETAILS_ID`, `NSD`.`REFERENCE_NUMBER` AS `REFERENCE_NUMBER`, substr(group_concat(`NST`.`SCRIPT` order by `NST`.`ID` ASC separator ''),1,1000000) AS `SCRIPT`, row_number()  () AS `OVER` FROM (`NSM_SCRIPT_DETAILS` `NSD` join `NSM_SCRIPT_TEXT` `NST` on((`NSD`.`ID` = `NST`.`SCRIPT_DETAILS_ID`))) WHERE (`NST`.`IS_ACTIVE` = 1) GROUP BY `NSD`.`ID`, `NSD`.`REFERENCE_NUMBER` ;

--
-- Indexes for dumped tables
--

--
-- Indexes for table `NSM_APPLICATION_LOOKUP`
--
ALTER TABLE `NSM_APPLICATION_LOOKUP`
  ADD PRIMARY KEY (`ID`);

--
-- Indexes for table `NSM_APPLICATION_LOOKUP_EVENT_TYPE`
--
ALTER TABLE `NSM_APPLICATION_LOOKUP_EVENT_TYPE`
  ADD PRIMARY KEY (`ID`);

--
-- Indexes for table `NSM_CONF_APPLICATION_USERS`
--
ALTER TABLE `NSM_CONF_APPLICATION_USERS`
  ADD PRIMARY KEY (`ID`),
  ADD KEY `NSM_CONF_APPLICATION_USERS_APPLICATION_LOOKUP_ID_FK` (`APPLICATION_LOOKUP_ID`);

--
-- Indexes for table `NSM_SCRIPT_DETAILS`
--
ALTER TABLE `NSM_SCRIPT_DETAILS`
  ADD PRIMARY KEY (`ID`),
  ADD KEY `NSM_SCRIPT_DETAILS_APPLICATION_TYPE_ID_FK` (`APPLICATION_TYPE_ID`);

--
-- Indexes for table `NSM_SCRIPT_DETAILS_EVENT_HISTORY`
--
ALTER TABLE `NSM_SCRIPT_DETAILS_EVENT_HISTORY`
  ADD PRIMARY KEY (`ID`),
  ADD KEY `NSM_SCRIPT_DETAILS_EVENT_HISTORY_RECORD_ID_FK` (`RECORD_ID`),
  ADD KEY `NSM_SCRIPT_DETAILS_EVENT_HISTORY_EVENT_TYPE_ID_FK` (`EVENT_TYPE_ID`);

--
-- Indexes for table `NSM_SCRIPT_DETAILS_EVENT_TYPE`
--
ALTER TABLE `NSM_SCRIPT_DETAILS_EVENT_TYPE`
  ADD PRIMARY KEY (`ID`);

--
-- Indexes for table `NSM_SCRIPT_TEXT`
--
ALTER TABLE `NSM_SCRIPT_TEXT`
  ADD PRIMARY KEY (`ID`),
  ADD KEY `NSM_SCRIPT_TEXT_SCRIPT_DETAILS_ID_FK` (`SCRIPT_DETAILS_ID`);

--
-- AUTO_INCREMENT for table `NSM_APPLICATION_LOOKUP`
--
ALTER TABLE `NSM_APPLICATION_LOOKUP`
  MODIFY `ID` int NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=4;

--
-- AUTO_INCREMENT for table `NSM_APPLICATION_LOOKUP_EVENT_TYPE`
--
ALTER TABLE `NSM_APPLICATION_LOOKUP_EVENT_TYPE`
  MODIFY `ID` int NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=3;

--
-- AUTO_INCREMENT for table `NSM_CONF_APPLICATION_USERS`
--
ALTER TABLE `NSM_CONF_APPLICATION_USERS`
  MODIFY `ID` int NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT for table `NSM_SCRIPT_DETAILS`
--
ALTER TABLE `NSM_SCRIPT_DETAILS`
  MODIFY `ID` int NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=5;

--
-- AUTO_INCREMENT for table `NSM_SCRIPT_DETAILS_EVENT_HISTORY`
--
ALTER TABLE `NSM_SCRIPT_DETAILS_EVENT_HISTORY`
  MODIFY `ID` int NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=6;

--
-- AUTO_INCREMENT for table `NSM_SCRIPT_DETAILS_EVENT_TYPE`
--
ALTER TABLE `NSM_SCRIPT_DETAILS_EVENT_TYPE`
  MODIFY `ID` int NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT for table `NSM_SCRIPT_TEXT`
--
ALTER TABLE `NSM_SCRIPT_TEXT`
  MODIFY `ID` int NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=18;

--
-- Constraints for dumped tables
--

--
-- Constraints for table `NSM_CONF_APPLICATION_USERS`
--
ALTER TABLE `NSM_CONF_APPLICATION_USERS`
  ADD CONSTRAINT `NSM_CONF_APPLICATION_USERS_APPLICATION_LOOKUP_ID_FK` FOREIGN KEY (`APPLICATION_LOOKUP_ID`) REFERENCES `NSM_APPLICATION_LOOKUP` (`ID`) ON DELETE RESTRICT;

--
-- Constraints for table `NSM_SCRIPT_DETAILS`
--
ALTER TABLE `NSM_SCRIPT_DETAILS`
  ADD CONSTRAINT `NSM_SCRIPT_DETAILS_APPLICATION_TYPE_ID_FK` FOREIGN KEY (`APPLICATION_TYPE_ID`) REFERENCES `NSM_APPLICATION_LOOKUP` (`ID`) ON DELETE RESTRICT;

--
-- Constraints for table `NSM_SCRIPT_DETAILS_EVENT_HISTORY`
--
ALTER TABLE `NSM_SCRIPT_DETAILS_EVENT_HISTORY`
  ADD CONSTRAINT `NSM_SCRIPT_DETAILS_EVENT_HISTORY_EVENT_TYPE_ID_FK` FOREIGN KEY (`EVENT_TYPE_ID`) REFERENCES `NSM_SCRIPT_DETAILS_EVENT_TYPE` (`ID`) ON DELETE RESTRICT,
  ADD CONSTRAINT `NSM_SCRIPT_DETAILS_EVENT_HISTORY_RECORD_ID_FK` FOREIGN KEY (`RECORD_ID`) REFERENCES `NSM_SCRIPT_DETAILS` (`ID`) ON DELETE RESTRICT;

--
-- Constraints for table `NSM_SCRIPT_TEXT`
--
ALTER TABLE `NSM_SCRIPT_TEXT`
  ADD CONSTRAINT `NSM_SCRIPT_TEXT_SCRIPT_DETAILS_ID_FK` FOREIGN KEY (`SCRIPT_DETAILS_ID`) REFERENCES `NSM_SCRIPT_DETAILS` (`ID`) ON DELETE RESTRICT;
COMMIT;
